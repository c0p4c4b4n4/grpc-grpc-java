1. Protobuf Definition
Define the service in a .proto file (e.g., echo.proto).
protobuf
syntax = "proto3";
option java_multiple_files = true;
package com.example.grpc;

service EchoService {
  rpc UnaryEcho(EchoRequest) returns (EchoResponse);
}

message EchoRequest { string message = 1; }
message EchoResponse { string message = 1; }
Use code with caution.

2. gRPC Server Implementation
The server extends the generated EchoServiceImplBase.
java
public class EchoServer {
    public static void main(String[] args) throws Exception {
        Server server = ServerBuilder.forPort(50051)
                .addService(new EchoServiceImpl())
                .build()
                .start();
        server.awaitTermination();
    }

    static class EchoServiceImpl extends EchoServiceGrpc.EchoServiceImplBase {
        @Override
        public void unaryEcho(EchoRequest req, StreamObserver<EchoResponse> responseObserver) {
            EchoResponse reply = EchoResponse.newBuilder().setMessage(req.getMessage()).build();
            responseObserver.onNext(reply);
            responseObserver.onCompleted();
        }
    }
}
Use code with caution.

3. Three Client Variants
Each client uses a different "stub" type generated by the gRPC compiler.
Synchronous (Blocking) Client: Uses EchoServiceBlockingStub. The execution halts until the server responds.
java
EchoServiceGrpc.EchoServiceBlockingStub blockingStub = EchoServiceGrpc.newBlockingStub(channel);
EchoResponse response = blockingStub.unaryEcho(EchoRequest.newBuilder().setMessage("Hello").build());
System.out.println(response.getMessage());
Use code with caution.

Asynchronous (Callback) Client: Uses EchoServiceStub. It returns immediately and handles the response via a StreamObserver.
java
EchoServiceGrpc.EchoServiceStub asyncStub = EchoServiceGrpc.newStub(channel);
asyncStub.unaryEcho(EchoRequest.newBuilder().setMessage("Hello").build(), new StreamObserver<EchoResponse>() {
    @Override public void onNext(EchoResponse value) { System.out.println(value.getMessage()); }
    @Override public void onError(Throwable t) { t.printStackTrace(); }
    @Override public void onCompleted() {}
});
Use code with caution.

ListenableFuture Client: Uses EchoServiceFutureStub. Returns a Guava ListenableFuture, allowing for composable asynchronous operations.
java
EchoServiceGrpc.EchoServiceFutureStub futureStub = EchoServiceGrpc.newFutureStub(channel);
ListenableFuture<EchoResponse> responseFuture = futureStub.unaryEcho(EchoRequest.newBuilder().setMessage("Hello").build());
Futures.addCallback(responseFuture, new FutureCallback<EchoResponse>() {
    @Override public void onSuccess(EchoResponse result) { System.out.println(result.getMessage()); }
    @Override public void onFailure(Throwable t) { t.printStackTrace(); }
}, MoreExecutors.directExecutor());
Use code with caution.

